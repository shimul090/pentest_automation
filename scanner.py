from fpdf import FPDF
import nmap

web_url = input('Enter the URL to scan: ')
nm = nmap.PortScanner()
nm.scan(web_url)


pdf = FPDF()
pdf.add_page()
pdf.set_font("Arial", size = 15)
pdf.cell(200, 10, txt = "Penetration Testing report generated from nmap", ln = 1, align = 'C')
pdf.set_font("Arial", size = 12)

for host in nm.all_hosts():
    if nm[host].hostname() == '':
        hostname = "Couldn't get the hostname"
    else:
        hostname = nm[host].hostname()
    pdf.cell(200, 10, txt="Hostname: " + host + '(' + hostname + ')', ln=1, align='L')
    pdf.cell(200, 10, txt="State: " + nm[host].state(), ln=1, align='L')
    for proto in nm[host].all_protocols():
        pdf.cell(200, 10, txt="----------", ln=1, align='L')
        pdf.cell(200, 10, txt="Protocol: " + proto, ln=1, align='L')
        lport = nm[host][proto].keys()
        for port in lport:
            pdf.cell(200, 10, txt="Port: " + str(port) + ', State: ' + nm[host][proto][port]['state'] , ln=1, align='L')
pdf.cell(200, 10, txt = "Disclaimer: This is a system generated report.", ln = 1, align = 'C')
pdf.output("/home/shimul/Documents/pentest/report.pdf")
print("Finished")